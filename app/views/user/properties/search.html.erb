
<%#binding.pry%>

<div class="container">
  <div class="row">

    <div class="col-3">
      <%= form_with url: search_path, method: :get do |f|%>
        <h3>エリア</h3>
        <%=f.collection_check_boxes :area_id, Area.all, :id, :area_name, checked: @checkd_areas %>
        <h3>家賃</h3>
        <%=f.select :lower_rent, Property.lower_select_rent_table,{selected: @lower_rent} %>〜
        <%=f.select :upper_rent, Property.upper_select_rent_table,{selected: @upper_rent}%>
        <h3>入居者の特性</h3>
        <%=f.collection_check_boxes :tag_id, @basic_tags, :id, :name, checked: params[:tag_id] %>
        <h3>部屋をこだわりたい!</h3>
        <%=f.collection_check_boxes :tag_id, @room_tags, :id, :name, checked: params[:tag_id] %>
        <h3>周辺環境をこだわりたい!</h3>
        <%=f.collection_check_boxes :tag_id, @surrounding_tags, :id, :name, checked: params[:tag_id] %>
        <h3>共有設備をこだわりたい!</h3>
        <%=f.collection_check_boxes :tag_id, @shared_facility_tags, :id, :name, checked: params[:tag_id] %>
        <h3><%=f.submit 'この条件で検索'%></h3>
      <%end%>
    </div>

    <div class="col-9">
      <div class="text-center">
        <p>全<%=@properties. count%>件</p>
        <p><%#=@properties.tags.name %>の物件</p>
      </div>
      <%@properties.each do |property|%>
        <div class="row">
        <div class="col-5">
          <h2><%=property.property_name%></h2>
            <% property.images.first(1).each do |image| %>
            <p><%= image_tag image,size: '300x230'%></p>
          <%end%>
        </div>

        <div class="col-7 mt-5">
          <table>
            <tr><th>賃料</th><td><%=property.rent%></td></tr>
            <tr><th>住所</th><td><%=property.address%></td></tr>
            <tr><th>アクセス</th><td><%=property.access%></td></tr>
            <tr><th>入居条件</th><td><%=property.condition%></td></tr>
            <tr><th>空室</th></th><td><%=property.vacancy%></td></tr>
            <tr><th>特徴</th></th><td><%property.tags.each do |tag|%><%=tag.name%><%end%></td></tr>
         </table>
        </div>
        </div>

      <div class="row">
      <div class="col-6">
      <%if user_signed_in? %>
         <%=link_to "詳細を見る",property_path(property.id)%>
       <%else%>
         <%= link_to new_user_registration_path do %>
         詳細を見る
         <%end%>
      <%end%>
     </div>
      <div class="col-6">
      <%if user_signed_in? %>
        <% if property.favorited_by?(current_user) %>
            <%= link_to property_favorites_path(property.id, 1), method: :delete do %>
              ♥<%= property.favorites.count %> お気に入り
            <% end %>
        <% else %>
              <%= link_to property_favorites_path(property.id), method: :post do %>
              ♡<%= property.favorites.count %> お気に入り
            <% end %>
        <% end %>
      <%else%>
         <%= link_to new_user_registration_path do %>
         ♡<%= property.favorites.count %> お気に入り
         <%end%>
      <%end%>
      </div>
     </div>
    <%end%>
  </div>
  </div>
 <%#= paginate @properties %>


